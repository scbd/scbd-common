{"version":3,"file":"cbd-article.cjs","sources":["../../../src/services/api/api-base.js","../../../src/services/api/articles.js","../../../src/services/filters/lstring.js","../../../src/components/articles/cbd-add-new-article.vue","../../../src/components/articles/cbd-add-new-article.vue?vue&type=template&id=8398571a&lang.js","../../../src/services/util/css.escape.js","../../../src/components/articles/cbd-article-cover-image.vue","../../../src/components/articles/cbd-article.vue","../../../src/components/articles/cbd-article.vue?vue&type=template&id=6420104c&lang.js"],"sourcesContent":["import axios from 'axios'\r\nimport { isFunction } from 'lodash'\r\nimport * as Vue from 'vue'\r\n\r\nlet sitePrefixUrl = 'https://api.cbd.int';\r\n\r\nif(/\\.cbd\\.int$/i   .test(window?.location?.hostname || '')) sitePrefixUrl= 'https://api.cbd.int';\r\nif(/\\.cbddev\\.xyz$/i.test(window?.location?.hostname || '')) sitePrefixUrl= 'https://api.cbddev.xyz';\r\nif(/\\localhost$/i   .test(window?.location?.hostname || '')) sitePrefixUrl= '/';\r\n\r\nconst defaultOptions = { \r\n   prefixUrl:  sitePrefixUrl, \r\n   timeout  : 30 * 1000,\r\n   token: Vue?.prototype?.$auth?.strategy?.token?.get()  \r\n}\r\n\r\nexport default class ApiBase\r\n{\r\n  constructor(options) {\r\n    options = options || {};\r\n\r\n    if(isFunction(options)) options = { token : options }\r\n\r\n    const { token, prefixUrl, timeout, tokenType } = { ...defaultOptions, ...options }\r\n\r\n    this.config = {\r\n      baseURL : prefixUrl,\r\n      timeout,\r\n      tokenType,\r\n      token,\r\n    }\r\n\r\n    const http = async function (...args) {   \r\n      return (await loadAsyncHeaders(this.config))(...args);\r\n    }\r\n\r\n    http.get     = async (...args)=> (await loadAsyncHeaders(this.config)).get    (...args);\r\n    http.head    = async (...args)=> (await loadAsyncHeaders(this.config)).head   (...args);\r\n    http.post    = async (...args)=> (await loadAsyncHeaders(this.config)).post   (...args);\r\n    http.put     = async (...args)=> (await loadAsyncHeaders(this.config)).put    (...args);\r\n    http.patch   = async (...args)=> (await loadAsyncHeaders(this.config)).patch  (...args);\r\n    http.delete  = async (...args)=> (await loadAsyncHeaders(this.config)).delete (...args);\r\n    http.options = async (...args)=> (await loadAsyncHeaders(this.config)).options(...args);\r\n    http.request = async (...args)=> (await loadAsyncHeaders(this.config)).request(...args);\r\n\r\n    this.http = http;\r\n  }\r\n}\r\n\r\nasync function loadAsyncHeaders(baseConfig) {\r\n\r\n  const { token, tokenType, ...config } = baseConfig || {}\r\n\r\n  const headers = { ...(config.headers || {}) };\r\n\r\n  if(token) {\r\n      headers.Authorization = `${tokenType||'Bearer'} ${token}`;\r\n  }\r\n\r\n  return axios.create({ ...config, headers } );\r\n\r\n}\r\n\r\n//////////////////////////\r\n// Helpers\r\n////////////////////////\r\n\r\nexport function tryCastToApiError(error) {\r\n\r\n  if(error && error.response && error.response.data && error.response.data.code) {\r\n      const apiError = error.response.data\r\n      throw error.response.data;\r\n  }\r\n\r\n  throw error\r\n}\r\n\r\nexport function stringifyUrlParam(value) {\r\n  if (value instanceof(Date))   {return value.toISOString()}    \r\n  if (value instanceof(Object)) {return JSON.stringify(value)}  \r\n  return value; \r\n}\r\n\r\nexport function stringifyUrlParams(valueObj) {\r\n  const returnObj = {};\r\n\r\n  for (const [key, value] of Object.entries(valueObj)) {\r\n    if (isValid(value)){\r\n      returnObj[key] = stringifyUrlParam(value);\r\n    }\r\n  }\r\n  \r\n  return returnObj;\r\n}\r\n\r\nexport function mapObjectId(id){  \r\n  return isObjectId(id)? { $oid: id } : id\r\n}\r\n\r\nexport function isObjectId(id){\r\n  return /^[a-f0-9]{24}/i.test(id);\r\n}\r\n\r\nexport function isValid(params){\r\n  return ![undefined, null].includes(params);\r\n}","\r\nimport ApiBase, { tryCastToApiError, stringifyUrlParam, stringifyUrlParams, isValid, mapObjectId} from './api-base';\r\n\r\nexport default class ArticlesApi extends ApiBase\r\n{\r\n  constructor(options) {\r\n    super(options);\r\n  }\r\n  \r\n  async getArticleGroup(groupKey, {q, f, s, sk, l , c, fo, ag }={})  {    \r\n    if(!isValid(groupKey)) throw Error(`invalid value for groupKey`); \r\n    const params = stringifyUrlParams( {q, f, s, sk, l , c, fo, ag });\r\n\r\n    return this.http.get(`api/v2017/articles/grouping/${encodeURIComponent(groupKey)}`,  { params } )\r\n                    .then(res => res.data)\r\n                    .catch(tryCastToApiError);\r\n   }\r\n\r\n  async getArticles({q, f, s, sk, l , c, fo, ag }={})  {\r\n    const params = stringifyUrlParams( {q, f, s, sk, l , c, fo, ag });\r\n\r\n    return this.http.get(`api/v2017/articles`,  { params } )\r\n                    .then(res => res.data)\r\n                    .catch(tryCastToApiError);\r\n  }\r\n\r\n  async getArticleById(id )  {\r\n    if(!isValid(id)) throw Error(`invalid value for id`);\r\n\r\n    return this.http.get(`api/v2017/articles/${id}`)\r\n                      .then(res => res.data)\r\n                      .catch(tryCastToApiError);  \r\n  }\r\n\r\n\r\n  async getArticlesByTag(tag, {q, f, s, sk, l , c, fo, ag }={})  {    \r\n    if(!isValid(tag)) throw Error(`invalid value for tag`);\r\n\r\n   const params=  stringifyUrlParams({q, f, s, sk, l , c, fo, ag });\r\n   const query = q;   \r\n   \r\n   if (tag){\r\n    params.q = stringifyUrlParam({...query, ...{tags: mapObjectId(tag)}});    \r\n   } \r\n\r\n    return this.http.get(`api/v2017/articles`,  { params })\r\n                    .then(res => res.data)\r\n                    .catch(tryCastToApiError);  \r\n }\r\n\r\n   \r\n\r\n  async getArticleAdminTags({q, f, s, sk, l , c, fo, ag }={}){    \r\n    const params = stringifyUrlParams( {q, f, s, sk, l , c, fo, ag });\r\n\r\n    return this.http.get(`api/v2021/article-admin-tags`,  { params } )\r\n                    .then(res => res.data)\r\n                    .catch(tryCastToApiError);\r\n\r\n  }\r\n }","\r\nexport function lstring(ltext, locale) {\r\n  \r\n    if(Number.isInteger(ltext)) //is number to handle generic implementation of NR\r\n      return ltext;\r\n  \r\n    if (!ltext)\r\n      return \"\";\r\n    if (typeof(ltext) == 'string')\r\n      return ltext;\r\n    let sText=\"\";\r\n    if (!sText && locale)\r\n      sText = ltext[locale];\r\n    if (!sText)\r\n      sText = ltext.en;\r\n    if (!sText) {\r\n      var normalized = normalizeText(ltext)\r\n      if(normalized[locale])\r\n        return normalized[locale];\r\n\r\n      for (var key in ltext) {\r\n        sText = ltext[key];\r\n        if (sText)\r\n          break;\r\n      }\r\n    }\r\n    return sText || \"\";\r\n}\r\n\r\n\r\nfunction normalizeText(text) {\r\n  if(!text) return null;\r\n\r\n  var entry = { ar: text.ar, en: text.en, es: text.es, fr: text.fr, ru: text.ru, zh: text.zh };\r\n\r\n  if(!entry.en) entry.en = entry.fr;\r\n  if(!entry.en) entry.en = entry.es;\r\n  if(!entry.en) entry.en = entry.ru;\r\n  if(!entry.en) entry.en = entry.ar;\r\n  if(!entry.en) entry.en = entry.zh;\r\n\r\n  if(!entry.fr) entry.fr = entry.en;\r\n  if(!entry.es) entry.es = entry.en;\r\n  if(!entry.ru) entry.ru = entry.en;\r\n  if(!entry.ar) entry.ar = entry.en;\r\n  if(!entry.zh) entry.zh = entry.en;\r\n  return entry;\r\n}","<template>\r\n     <a :href=\"newArticleUrl\" :target=\"target\">\r\n        <slot>\r\n            <span v-if=\"!id\"><i class=\"fa fa-plus\"></i> Add Content</span>\r\n            <span v-if=\"id\" ><i class=\"fa fa-edit\"></i> Edit Content</span>\r\n            \r\n        </slot>\r\n    </a>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name:'cbdAddNewArticle',\r\n        props: {\r\n            tags \t\t: { type: Array  , required: false, default:[]           }, // [] of tag id's\r\n            customTags \t: { type: Array  , required: false, default:[]           }, // [] of customTag id's\r\n            adminTags \t: { type: Array  , required: false, default:[]           }, // [] of adminTag text\r\n            target      : { type: String , required: false, default: '_blank'    },\r\n            id          : { type: String , required: false, default: undefined   },\r\n        },\r\n        computed: {\r\n            newArticleUrl : function(){\r\n\r\n                const domain = window.location.hostname.replace(/[^\\.]+\\./, '');\r\n\t\t\t\tlet baseUrl = 'https://www.cbd.int/management'\r\n\r\n\t\t\t\tif(domain=='localhost' || domain == 'cbddev.xyz')\r\n            \t\tbaseUrl = 'https://oasis.cbddev.xyz';\r\n\r\n\t\t\t\tconst queryString = [];\r\n                if(!this.id){\r\n                    if(this.tags?.length)\r\n                        queryString.push('tags='\t\t+ this.tags.map(encodeURIComponent).join(','))\r\n                    if(this.customTags?.length)\r\n                        queryString.push('customTags='\t+ this.customTags.map(encodeURIComponent).join(','))\r\n                    if(this.adminTags?.length)\r\n                        queryString.push('adminTags='\t+ this.adminTags.map(encodeURIComponent).join(','))\r\n                }\r\n\r\n                queryString.push('returnUrl=' + encodeURI(window.location.href));\r\n\r\n                if(!this.id)\r\n                    return `${baseUrl}/articles/new?${queryString.join('&')}`\r\n                \r\n                return  `${baseUrl}/articles/${encodeURIComponent(this.id)}/edit?${queryString.join('&')}`;\r\n            }\r\n        }\r\n    }\r\n</script>\r\n","<template>\r\n     <a :href=\"newArticleUrl\" :target=\"target\">\r\n        <slot>\r\n            <span v-if=\"!id\"><i class=\"fa fa-plus\"></i> Add Content</span>\r\n            <span v-if=\"id\" ><i class=\"fa fa-edit\"></i> Edit Content</span>\r\n            \r\n        </slot>\r\n    </a>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name:'cbdAddNewArticle',\r\n        props: {\r\n            tags \t\t: { type: Array  , required: false, default:[]           }, // [] of tag id's\r\n            customTags \t: { type: Array  , required: false, default:[]           }, // [] of customTag id's\r\n            adminTags \t: { type: Array  , required: false, default:[]           }, // [] of adminTag text\r\n            target      : { type: String , required: false, default: '_blank'    },\r\n            id          : { type: String , required: false, default: undefined   },\r\n        },\r\n        computed: {\r\n            newArticleUrl : function(){\r\n\r\n                const domain = window.location.hostname.replace(/[^\\.]+\\./, '');\r\n\t\t\t\tlet baseUrl = 'https://www.cbd.int/management'\r\n\r\n\t\t\t\tif(domain=='localhost' || domain == 'cbddev.xyz')\r\n            \t\tbaseUrl = 'https://oasis.cbddev.xyz';\r\n\r\n\t\t\t\tconst queryString = [];\r\n                if(!this.id){\r\n                    if(this.tags?.length)\r\n                        queryString.push('tags='\t\t+ this.tags.map(encodeURIComponent).join(','))\r\n                    if(this.customTags?.length)\r\n                        queryString.push('customTags='\t+ this.customTags.map(encodeURIComponent).join(','))\r\n                    if(this.adminTags?.length)\r\n                        queryString.push('adminTags='\t+ this.adminTags.map(encodeURIComponent).join(','))\r\n                }\r\n\r\n                queryString.push('returnUrl=' + encodeURI(window.location.href));\r\n\r\n                if(!this.id)\r\n                    return `${baseUrl}/articles/new?${queryString.join('&')}`\r\n                \r\n                return  `${baseUrl}/articles/${encodeURIComponent(this.id)}/edit?${queryString.join('&')}`;\r\n            }\r\n        }\r\n    }\r\n</script>\r\n","// https://raw.githubusercontent.com/mathiasbynens/CSS.escape/master/css.escape.js\r\n\t\r\nexport const cssEscape = function(value) {\r\n    if (arguments.length == 0) {\r\n        throw new TypeError('`CSS.escape` requires an argument.');\r\n    }\r\n    var string = String(value);\r\n    var length = string.length;\r\n    var index = -1;\r\n    var codeUnit;\r\n    var result = '';\r\n    var firstCodeUnit = string.charCodeAt(0);\r\n\r\n    if (\r\n        // If the character is the first character and is a `-` (U+002D), and\r\n        // there is no second character, […]\r\n        length == 1 &&\r\n        firstCodeUnit == 0x002D\r\n    ) {\r\n        return '\\\\' + string;\r\n    }\r\n\r\n    while (++index < length) {\r\n        codeUnit = string.charCodeAt(index);\r\n        // Note: there’s no need to special-case astral symbols, surrogate\r\n        // pairs, or lone surrogates.\r\n\r\n        // If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\r\n        // (U+FFFD).\r\n        if (codeUnit == 0x0000) {\r\n            result += '\\uFFFD';\r\n            continue;\r\n        }\r\n\r\n        if (\r\n            // If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\r\n            // U+007F, […]\r\n            (codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\r\n            // If the character is the first character and is in the range [0-9]\r\n            // (U+0030 to U+0039), […]\r\n            (index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\r\n            // If the character is the second character and is in the range [0-9]\r\n            // (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\r\n            (\r\n                index == 1 &&\r\n                codeUnit >= 0x0030 && codeUnit <= 0x0039 &&\r\n                firstCodeUnit == 0x002D\r\n            )\r\n        ) {\r\n            // https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\r\n            result += '\\\\' + codeUnit.toString(16) + ' ';\r\n            continue;\r\n        }\r\n\r\n        // If the character is not handled by one of the above rules and is\r\n        // greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\r\n        // is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\r\n        // U+005A), or [a-z] (U+0061 to U+007A), […]\r\n        if (\r\n            codeUnit >= 0x0080 ||\r\n            codeUnit == 0x002D ||\r\n            codeUnit == 0x005F ||\r\n            codeUnit >= 0x0030 && codeUnit <= 0x0039 ||\r\n            codeUnit >= 0x0041 && codeUnit <= 0x005A ||\r\n            codeUnit >= 0x0061 && codeUnit <= 0x007A\r\n        ) {\r\n            // the character itself\r\n            result += string.charAt(index);\r\n            continue;\r\n        }\r\n\r\n        // Otherwise, the escaped character.\r\n        // https://drafts.csswg.org/cssom/#escape-a-character\r\n        result += '\\\\' + string.charAt(index);\r\n    }\r\n    return result;\r\n};\r\n","<template>\r\n     <div class=\"image-credit-wrapper\"  v-if=\"coverImage.url\">    \r\n        <div :class=\"'img cover-image cover-image-position-' + (coverImage.position||'center') + ' cover-image-size-' + (coverImage.size||'cover')\" \r\n            v-if=\"coverImage.url_1200||coverImage.url\" :style=\"'background-image: url(' + cssEscapeUrl(coverImage.url_1200||coverImage.url) + ');'\">\r\n        </div>    \r\n        <span class=\"image-credit\" v-if=\"coverImage.credits\">{{coverImage.credits}}</span>\r\n        <slot></slot>\r\n    </div>\r\n</template>\r\n \r\n<script setup>\r\n    import { cssEscape } from '../../services/util/css.escape';\r\n    const { coverImage } = defineProps({\r\n        coverImage: {\r\n            type: Object,\r\n            required: true\r\n        }\r\n    });\r\n    \r\n    const cssEscapeUrl = function(url) {\r\n        return cssEscape(url);\r\n    }\r\n    //  const cssEscapeUrl = (url) => cssEscape(url);\r\n\r\n</script>\r\n<style scoped>\r\n.image-credit-wrapper img {\r\n    width: 100% !important;\r\n}\r\n\r\n.image-credit-wrapper {\r\n    overflow: hidden;\r\n    position: relative;\r\n    /* margin-left: -15px;\r\n    margin-right: -15px; */\r\n    max-height: 375px;\r\n    width: 100%\r\n}\r\n\r\n.image-credit-wrapper .image-credit {\r\n    position: absolute;\r\n    right: 0px;\r\n    bottom: 4px;\r\n}\r\n\r\n.image-credit {\r\n    background: rgba(0, 0, 0, .7);\r\n    color: #ccc;\r\n    display: inline-block;\r\n    font-size: 11px;\r\n    font-family: helvetica;\r\n    font-weight: 300;\r\n    padding: 5px 8px;\r\n    position: absolute;\r\n    bottom: 0;\r\n    right: 0;\r\n}\r\n\r\n.cover-image{\r\n    width: 100%;\r\n    background-repeat: no-repeat;\r\n    position: absolute;\r\n    top: 0px;\r\n    right: 0px;\r\n    bottom: 0px;\r\n    left: 0px;\r\n\r\n}\r\n\r\n.cover-image-position-left{\r\n    background-position: left;\r\n}                                    \r\n.cover-image-position-right{\r\n    background-position: right;\r\n} \r\n.cover-image-position-top{\r\n    background-position: top;\r\n}                                    \r\n.cover-image-position-center{\r\n    background-position: center;\r\n}                                            \r\n.cover-image-position-bottom{\r\n    background-position: bottom;\r\n}\r\n\r\n.cover-image-size-cover{\r\n    background-size: cover;\r\n}\r\n.cover-image-size-contain{\r\n    background-size: contain;\r\n}\r\n@media (max-width: 767px) {\r\n    /*For all phone sizes*/\r\n    .image-credit-wrapper{\r\n        height: 120px;\r\n    }\r\n}\r\n\r\n@media (min-width: 768px) and (max-width: 991px) {\r\n    /* For IPads*/\r\n    .image-credit-wrapper{\r\n        height: 250px;\r\n    }\r\n}\r\n@media (min-width: 992px) and (max-width: 1199px) {\r\n    /* For IPad pro*/\r\n    .image-credit-wrapper{\r\n        height: 300px;\r\n    }\r\n}\r\n@media (min-width: 1200px) {\r\n    /* For big screens*/\r\n    .image-credit-wrapper{\r\n        height: 350px;\r\n    }\r\n}\r\n</style>\r\n","\r\n<template>\r\n   <div style=\"border:none;margin-top:10px\">\r\n        <div v-if=\"!loading\">\r\n        \r\n            <slot name=\"article-cover-image\">\r\n                <div v-if=\"!hideCoverImage && article && article.coverImage && article.coverImage.url\" >\r\n                    <cbd-article-cover-image :cover-image=\"article.coverImage\"></cbd-article-cover-image>\r\n                </div>\r\n            </slot>\r\n\r\n            <slot name=\"article-add-new\">\r\n                <div v-if=\"hasEditRights\" class=\"pull-right\">    \r\n                    <cbd-add-new-article :tags=\"tags\" :admin-tags=\"adminTags\" :custom-tags=\"customTags\" :id=\"(article||{})._id\" \r\n                        :target=\"showEditTarget\" class=\"btn btn-default\"></cbd-add-new-article>\r\n                </div>\r\n            </slot>\r\n            <slot name=\"article\">\r\n                <div v-if=\"article\" v-html=\"$options.filters.lstring(article.content, $locale)\" class=\"ck-content\"></div>\r\n            </slot>\r\n\r\n            <slot name=\"article-empty\">\r\n                <div v-if=\"!article\" class=\"ck-content\">No information is available for this section at the moment.</div>\r\n            </slot>\r\n\r\n        </div>\r\n        <slot name=\"article-loading\">\r\n            <div v-if=\"loading\">Loading content... <i class=\"fa fa-spinner fa-spin\"></i></div>\r\n        </slot>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nimport axios from 'axios';\r\nimport ArticlesApi from '../../services/api/articles';\r\nimport {lstring } from '../../services/filters/lstring'\r\nimport cbdAddNewArticle from './cbd-add-new-article.vue';\r\nimport cbdArticleCoverImage from './cbd-article-cover-image.vue';\r\n\r\nexport default {\r\n    name: 'cbdArticle',\r\n    components : { \r\n        cbdAddNewArticle, \r\n        cbdArticleCoverImage \r\n    },\r\n    props: {\r\n        hideCoverImage  : { type: Boolean, required: false, default:false        },\r\n        showEdit        : { type: Boolean, required: false, default:true         },\r\n        showEditTarget  : { type: String , required: false, default: '_self'     },\r\n        showEditRoles   : { type: Array  , required: false, default:[]           }, // [] of scope roles\r\n        article         : { type: Object,  required: false, default:undefined    },\r\n        query           : { type: Object,  required: false                       },\r\n        tags \t\t    : { type: Array  , required: false, default:[]           }, // [] of tag id's\r\n        customTags \t    : { type: Array  , required: false, default:[]           }, // [] of customTag id's\r\n        adminTags \t    : { type: Array  , required: false, default:[]           }, // [] of adminTag text\r\n    },\r\n    data() {\r\n        return {\r\n            returnUrl       : window.location.href,\r\n            hasEditRights   : false,\r\n            loading         : false\r\n        }\r\n    },\r\n    created() {\r\n       this.ArticlesApi = new ArticlesApi();\r\n    },\r\n    mounted() {\r\n        if(!this.article && this.query)\r\n            this.loadArticle();\r\n    },\r\n    methods: {\r\n        async loadArticle() {\r\n            try{\r\n                this.loading = true;\r\n                const query = this.query;\r\n                const articleResult = await this.ArticlesApi.queryArticles(query)\r\n     \r\n                if(articleResult.length){\r\n                    let lArticle = articleResult[0];\r\n\r\n                    this.preProcessOEmbed();\r\n\r\n                    if(lArticle.coverImage?.url){\r\n                        //sometime the file name has space/special chars, use new URL's href prop which encodes the special chars\r\n                        const url = new URL(lArticle.coverImage.url)\r\n                        lArticle.coverImage.url = url.href;\r\n\r\n                        lArticle.coverImage.url_1200  = lArticle.coverImage.url.replace(/attachments\\.cbd\\.int\\//, '$&1200x600/')\r\n                    }\r\n                    this.article = lArticle;\r\n                    this.$emit('load', { ...this.article });   \r\n                }\r\n                else {\r\n                    this.$emit('load');\r\n                }\r\n\r\n                this.$auth.fetchUser().then(()=>{\r\n                    if(this.showEdit || this.showEdit == 'true' || this.hasOwnProperty(this.showEdit)){\r\n\r\n                        let roles = [...this.showEditRoles, 'oasisArticleEditor', 'Administrator']\r\n                        this.hasEditRights = this.$auth.hasScope(roles);\r\n                    }\r\n                })\r\n            }\r\n            catch(e){\r\n                console.error(e)\r\n            }\r\n            finally{\r\n                this.loading = false;\r\n            }\r\n        },\r\n        preProcessOEmbed() {\r\n\r\n            setTimeout(function(){\r\n\r\n                document.querySelectorAll( 'oembed[url]' ).forEach(async function(element) {\r\n                    var url = element.attributes.url.value;\r\n                    var params = {\r\n                        url : encodeURI(url),\r\n                    }\r\n\r\n                    const response = await axios.get('/api/v2020/oembed', {params:params});                    \r\n                    var embedHtml = '<div class=\"ck-media__wrapper\" style=\"width:100%\">' + response.data.html +'</div>'\r\n                    element.insertAdjacentHTML(\"afterend\", embedHtml);\r\n                    \r\n                });\r\n\r\n            }, 500)\r\n        }\r\n    },\r\n    filters:{\r\n        lstring\r\n    }\r\n}\r\n</script>\r\n    \r\n<style>\r\n\r\n    @import url('https://cdn.jsdelivr.net/npm/@scbd/ckeditor5-build-inline-full@35.0.0/build/content-style.css');\r\n\r\n</style>\r\n","\r\n<template>\r\n   <div style=\"border:none;margin-top:10px\">\r\n        <div v-if=\"!loading\">\r\n        \r\n            <slot name=\"article-cover-image\">\r\n                <div v-if=\"!hideCoverImage && article && article.coverImage && article.coverImage.url\" >\r\n                    <cbd-article-cover-image :cover-image=\"article.coverImage\"></cbd-article-cover-image>\r\n                </div>\r\n            </slot>\r\n\r\n            <slot name=\"article-add-new\">\r\n                <div v-if=\"hasEditRights\" class=\"pull-right\">    \r\n                    <cbd-add-new-article :tags=\"tags\" :admin-tags=\"adminTags\" :custom-tags=\"customTags\" :id=\"(article||{})._id\" \r\n                        :target=\"showEditTarget\" class=\"btn btn-default\"></cbd-add-new-article>\r\n                </div>\r\n            </slot>\r\n            <slot name=\"article\">\r\n                <div v-if=\"article\" v-html=\"$options.filters.lstring(article.content, $locale)\" class=\"ck-content\"></div>\r\n            </slot>\r\n\r\n            <slot name=\"article-empty\">\r\n                <div v-if=\"!article\" class=\"ck-content\">No information is available for this section at the moment.</div>\r\n            </slot>\r\n\r\n        </div>\r\n        <slot name=\"article-loading\">\r\n            <div v-if=\"loading\">Loading content... <i class=\"fa fa-spinner fa-spin\"></i></div>\r\n        </slot>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nimport axios from 'axios';\r\nimport ArticlesApi from '../../services/api/articles';\r\nimport {lstring } from '../../services/filters/lstring'\r\nimport cbdAddNewArticle from './cbd-add-new-article.vue';\r\nimport cbdArticleCoverImage from './cbd-article-cover-image.vue';\r\n\r\nexport default {\r\n    name: 'cbdArticle',\r\n    components : { \r\n        cbdAddNewArticle, \r\n        cbdArticleCoverImage \r\n    },\r\n    props: {\r\n        hideCoverImage  : { type: Boolean, required: false, default:false        },\r\n        showEdit        : { type: Boolean, required: false, default:true         },\r\n        showEditTarget  : { type: String , required: false, default: '_self'     },\r\n        showEditRoles   : { type: Array  , required: false, default:[]           }, // [] of scope roles\r\n        article         : { type: Object,  required: false, default:undefined    },\r\n        query           : { type: Object,  required: false                       },\r\n        tags \t\t    : { type: Array  , required: false, default:[]           }, // [] of tag id's\r\n        customTags \t    : { type: Array  , required: false, default:[]           }, // [] of customTag id's\r\n        adminTags \t    : { type: Array  , required: false, default:[]           }, // [] of adminTag text\r\n    },\r\n    data() {\r\n        return {\r\n            returnUrl       : window.location.href,\r\n            hasEditRights   : false,\r\n            loading         : false\r\n        }\r\n    },\r\n    created() {\r\n       this.ArticlesApi = new ArticlesApi();\r\n    },\r\n    mounted() {\r\n        if(!this.article && this.query)\r\n            this.loadArticle();\r\n    },\r\n    methods: {\r\n        async loadArticle() {\r\n            try{\r\n                this.loading = true;\r\n                const query = this.query;\r\n                const articleResult = await this.ArticlesApi.queryArticles(query)\r\n     \r\n                if(articleResult.length){\r\n                    let lArticle = articleResult[0];\r\n\r\n                    this.preProcessOEmbed();\r\n\r\n                    if(lArticle.coverImage?.url){\r\n                        //sometime the file name has space/special chars, use new URL's href prop which encodes the special chars\r\n                        const url = new URL(lArticle.coverImage.url)\r\n                        lArticle.coverImage.url = url.href;\r\n\r\n                        lArticle.coverImage.url_1200  = lArticle.coverImage.url.replace(/attachments\\.cbd\\.int\\//, '$&1200x600/')\r\n                    }\r\n                    this.article = lArticle;\r\n                    this.$emit('load', { ...this.article });   \r\n                }\r\n                else {\r\n                    this.$emit('load');\r\n                }\r\n\r\n                this.$auth.fetchUser().then(()=>{\r\n                    if(this.showEdit || this.showEdit == 'true' || this.hasOwnProperty(this.showEdit)){\r\n\r\n                        let roles = [...this.showEditRoles, 'oasisArticleEditor', 'Administrator']\r\n                        this.hasEditRights = this.$auth.hasScope(roles);\r\n                    }\r\n                })\r\n            }\r\n            catch(e){\r\n                console.error(e)\r\n            }\r\n            finally{\r\n                this.loading = false;\r\n            }\r\n        },\r\n        preProcessOEmbed() {\r\n\r\n            setTimeout(function(){\r\n\r\n                document.querySelectorAll( 'oembed[url]' ).forEach(async function(element) {\r\n                    var url = element.attributes.url.value;\r\n                    var params = {\r\n                        url : encodeURI(url),\r\n                    }\r\n\r\n                    const response = await axios.get('/api/v2020/oembed', {params:params});                    \r\n                    var embedHtml = '<div class=\"ck-media__wrapper\" style=\"width:100%\">' + response.data.html +'</div>'\r\n                    element.insertAdjacentHTML(\"afterend\", embedHtml);\r\n                    \r\n                });\r\n\r\n            }, 500)\r\n        }\r\n    },\r\n    filters:{\r\n        lstring\r\n    }\r\n}\r\n</script>\r\n    \r\n<style>\r\n\r\n    @import url('https://cdn.jsdelivr.net/npm/@scbd/ckeditor5-build-inline-full@35.0.0/build/content-style.css');\r\n\r\n</style>\r\n"],"names":["Vue","isFunction","axios","_createElementVNode","_createElementBlock","_renderSlot","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","cbdAddNewArticle","cbdArticleCoverImage","_openBlock","_createVNode"],"mappings":"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"}