{"version":3,"file":"km-input-lstring-ml.umd.js","sources":["../../../src/components/controls/km-input-lstring.vue","../../../src/services/util/helper.js","../../../src/components/controls/km-input-lstring-ml.vue"],"sourcesContent":["<template>\r\n  <div class=\"scbd-controls km-input-lstring\" >\r\n    <slot></slot>\r\n    <div class=\"input-group mb-1\" v-for=\"locale in locales\" :key=\"locale\" :class=\"`km-input-lstring-${locale}`\">\r\n      <input     v-if=\"rows==1\" type=\"text\"  class=\"form-control\" :placeholder=\"placeholder\" aria-describedby=\"lstring-text\"     v-model=\"model[locale]\" :dir=\"locale == 'ar' ? 'rtl' : 'ltr'\" @input=\"$emit('update:modelValue', model)\"/> \r\n      <textarea  v-if=\"rows>1\"  :rows=rows   class=\"form-control\" :placeholder=\"placeholder\" aria-describedby=\"lstring-textarea\" v-model=\"model[locale]\" :dir=\"locale == 'ar' ? 'rtl' : 'ltr'\" @input=\"$emit('update:modelValue', model)\"/>      \r\n    \r\n      <div class=\"input-group-append\">\r\n        <button class=\"btn btn-outline-primary\" type=\"button\" id=\"basic-addon2\" :data-bs-toggle=\"'tooltip'\" :data-bs-placement=\"'top'\" :title=\"getTerm(locale).title\">\r\n          {{ locale.toUpperCase() }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { watch, onMounted } from \"vue\";\r\n    import { without } from \"lodash\";\r\n\r\n    const model = defineModel({type:Object, required: true, default:{}})\r\n    const props = defineProps({\r\n      locales:  { type: Array, required: true },\r\n      disabled: { type: Boolean, default: false },\r\n      rows:     { type: Number, required: false, default: 1 },\r\n      placeholder: {type: String, required: false }\r\n    });\r\n\r\n    const loadLanguages = () => {\r\n      props.locales?.forEach((e) => {\r\n        //TODO: call thesaurus service API\r\n      });\r\n    };\r\n\r\n    const getTerm = (term) => {\r\n      //TODO: call thesaurus service API\r\n      return { title: term };\r\n    };\r\n\r\n    watch(()=>props.locales,\r\n      (newVal, oldVal) => {\r\n        const deleted = without(Object.keys(model.value), ...newVal);\r\n        if (deleted?.length) {\r\n          deleted.forEach((e) => {\r\n            model.value[e] = undefined;\r\n          });\r\n        }\r\n        loadLanguages();\r\n      }, {deep:true}\r\n    );\r\n\r\n    onMounted(() => {\r\n      loadLanguages();\r\n    });\r\n</script>\r\n","import _ from 'lodash';\r\n\r\nexport const makeSmallUid = () => {\r\n    const key = (S4() + S4()).toUpperCase();\r\n    return 'uid-' + key;\r\n}\r\n\r\nexport function S4() {\r\n    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n}\r\n\r\nexport const removeEmpty = (obj)=> {\r\n    return function remove(current) {\r\n      _.forOwn(current, function (value, key) {\r\n        if (_.isUndefined(value) || _.isNull(value) || _.isNaN(value) ||\r\n          (_.isString(value) && _.isEmpty(value)) ||\r\n          (_.isObject(value) && _.isEmpty(remove(value)))) {\r\n  \r\n          delete current[key];\r\n        }\r\n      });\r\n\r\n      if (_.isArray(current)) _.pull(current, undefined);\r\n  \r\n      return current;\r\n  \r\n    }(_.cloneDeep(obj));\r\n}","<template>\r\n  <div :id=\"$attrs.id\" class=\"scbd-controls km-input-lstring-ml\" :class=\"$attrs.class\">\r\n    <div v-for=\"(item, index) in binding\" :key=\"item\">\r\n      <div class=\"row\">\r\n        <div class=\"col-md-11\">\r\n          <km-input-lstring\r\n            v-model=\"item.value\"\r\n            :locales=\"props.locales\"\r\n            @update:modelValue=\"emitChange\"\r\n          ></km-input-lstring>\r\n        </div>\r\n        <div class=\"col-md-1\">\r\n          <button\r\n            :disabled=\"index == binding.length-1\"\r\n            class=\"btn btn-danger btn-sm\"\r\n            type=\"button\"\r\n            @click=\"removeItem(item, index)\"\r\n          >\r\n            <i class=\"bi bi-trash\"></i> {{ t(\"remove\") }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  ref,\r\n  onMounted,\r\n  defineProps,\r\n  defineEmits,\r\n} from \"vue\";\r\nimport { isEmpty } from \"lodash\";\r\nimport KmInputLstring from \"./km-input-lstring.vue\";\r\nimport { removeEmpty } from \"../../services/util/helper.js\";\r\n\r\nfunction t(str) {\r\n  return str;\r\n}\r\nconst props = defineProps({\r\n  locales: {\r\n    type: Array,\r\n    required: true,\r\n    validator:(value) => {\r\n      return value.every(locale => locale.length <= 3); // we use ISO-2 but need support for ISO-3\r\n    }\r\n  },\r\n  modelValue: {\r\n    type: Array,\r\n    required: false,\r\n    default: () => [{}],\r\n  },\r\n  disabled: {\r\n    type: Boolean,\r\n    required: false,\r\n  },\r\n});\r\n\r\nconst emit = defineEmits([\"update:modelValue\"]);\r\nconst binding = ref([{ value: {} }]);\r\n\r\nfunction addItem() {\r\n  binding.value.push({ value: {} });\r\n}\r\n\r\nfunction removeItem(item, index) {\r\n  binding.value?.splice(index, 1);\r\n}\r\n\r\nfunction emitChange(value) {\r\n  const clean = removeEmpty(binding.value);\r\n \r\n  emit(\"update:modelValue\", clean?.map((e) => e.value));\r\n\r\n  if (binding.value?.length) {\r\n    if (!binding.value.some((e) => isEmpty(e.value))) {\r\n      addItem();\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  if (props.modelValue) {\r\n    binding.value = props.modelValue.map((e) => {\r\n      return { value: e };\r\n    });\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped></style>\r\n"],"names":["model","_useModel","__props","props","loadLanguages","_props$locales","locales","forEach","e","getTerm","term","title","watch","newVal","oldVal","deleted","without","Object","keys","value","length","undefined","deep","onMounted","removeEmpty","obj","remove","current","_","forOwn","key","isUndefined","isNull","isNaN","isString","isEmpty","isObject","isArray","pull","cloneDeep","t","str","emit","__emit","binding","ref","addItem","push","removeItem","item","index","_binding$value","splice","emitChange","_binding$value2","clean","map","some","modelValue"],"mappings":"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"}