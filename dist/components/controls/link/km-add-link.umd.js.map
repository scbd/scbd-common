{"version":3,"file":"km-add-link.umd.js","sources":["../../../../src/data/language.js","../../../../src/components/controls/link/km-view-links.vue","../../../../src/components/controls/link/link-editor.vue","../../../../src/components/controls/link/km-add-link.vue"],"sourcesContent":["export const languages = {\r\n    \"ar\" : \"العربية\",\r\n    \"zh\" : \"中文\",\r\n    \"en\" : \"English\",\r\n    \"es\" : \"Español\",\r\n    \"fr\" : \"Français\",\r\n    \"ru\" : \"Русский\"\r\n}","<template>\r\n    <div class=\"scbd-common km-view-links\">\r\n        <table class=\" table table-striped\" v-if=\"links?.length\"> \r\n            <tbody>\r\n                <tr  v-for=\"(item, index) in links\" :key=\"index\">  \r\n                    <td  class=\"align-middle\" >\r\n                        <span> {{languages[item.language]}}  </span>    \r\n                    </td>        \r\n                    <td  class=\"align-middle\" >                                 \r\n                        <a :href=\"item.url\" >\r\n                            {{item.name}} \r\n                        </a>\r\n                    </td>   \r\n                    <td  class=\"align-middle\" >                                   \r\n                        <span v-if=\"item.tag\">\r\n                            ({{ item.tag }})\r\n                        </span>            \r\n                    </td>  \r\n                    <td class=\"text-nowrap text-right align-middle\">              \r\n                        <button class=\"btn btn-outline-secondary\" @click=\"edit(index)\"><i class=\"bi bi-pencil-square\"></i></button>\r\n                        <button class=\"btn btn-outline-secondary\" @click=\"remove(index)\"><i class=\"bi bi-trash3\"></i></button>\r\n                    </td>      \r\n            </tr>             \r\n            </tbody>\r\n        </table> \r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n  import { defineEmits, computed } from 'vue'\r\n  import { languages } from '../../../data/language'\r\n\r\n  const model = defineModel({type:Array, required:true});\r\n  const emit = defineEmits(['onDelete','onEdit']);\r\n   \r\n    let links = computed(()=>{\r\n        if(model.value)\r\n            return  model.value;\r\n        return [];\r\n    });   \r\n \r\n    const remove = (index) =>{    \r\n        emit(\"onDelete\", index);        \r\n    }\r\n\r\n    const edit = (index) =>{    \r\n        emit(\"onEdit\", index);        \r\n    }\r\n</script>","<template> \r\n    <div id=\"linkEditorModal\" v-if=\"modalOpen\" class=\"modal fade show overflow-auto d-block scbd-controls link-editor\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"linkEditor\" >\r\n        <div class=\"modal-dialog\" role=\"document\" >\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">     \r\n                    <h3 class=\"modal-title\"><slot name=\"modalTitle\">Editing link</slot></h3>  \r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"  @click=\"close\" >\r\n                    <span aria-hidden=\"true\">×</span>\r\n                    </button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                        <div class=\"alert alert-info\">Please provide the URL of the website (e.g.\r\n                            <a rel=\"noopener\" translation-url target=\"_blank\" href=\"http://www.cbd.int\">https://www.cbd.int</a> )and the name of the website (e.g. \"The Convention on Biological Diversity\").\r\n                        </div>                  \r\n                        <form>\r\n                        <div class=\"mb-3\" >\r\n                            <label class=\"col-form-label\" for=\"url\">Url <span class=\"text-danger\"> *</span></label><br/>\r\n                            <small class=\"help-block\">Protocol is required (https:// or http://)</small>                                \r\n                            <input class=\"form-control\"  id =\"url\" v-model=\"link.url\" type=\"url\"  placeholder=\" https://www.\" />\r\n                            <p v-if=\" checkValidation &&  !isUrlValid\"  ><span class=\"text-danger\"> Please provide valid URL</span></p>\r\n                        </div>\r\n                        <div class=\"mb-3\" >\r\n                            <label for=\"name\" class=\"col-form-label\" >Name</label>\r\n                            <input class=\"form-control\" id=\"name\" v-model=\"link.name\" type=\"text\"  placeholder=\"example:SCBD website\" />\r\n                        </div>\r\n                        <div class=\"mb-3\">\r\n                            <label for=\"language\" class=\"col-form-label\">Language <span class=\"text-danger\"> *</span></label>   \r\n                                <select class=\"form-select\"  name=\"language\" id=\"language\" v-model=\"link.language\"> \r\n                                <option v-for=\"(language, key) in languages\" :value=\"key\" :key=\"key\">{{ language }}</option> \r\n                            </select>\r\n                            <p v-if=\"checkValidation && !isLangValid\"  ><span class=\"text-danger\"> Please select Language </span></p>\r\n                        </div>\r\n                        </form>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" @click=\"close\" >Cancel</button>\r\n                    <button type=\"button\" class=\"btn btn-primary  \" @click=\"save\" >Save</button>  \r\n                </div>    \r\n            </div>        \r\n        </div>\r\n    </div>     \r\n  </template>\r\n  \r\n  <script setup >\r\n    import { defineEmits, ref, computed } from \"vue\"; \r\n    import { languages } from '../../../data/language';\r\n    \r\n    //TODO: use km-form-control when its available    \r\n    \r\n    const modalOpen = ref(false) ;\r\n    const link = ref({});     \r\n  \r\n    const emit = defineEmits(['onClose']);\r\n    const isUrlValid  = computed(()=>{ return isValidHttpUrl(link.value.url)});\r\n    const isLangValid = computed(()=>!!link.value?.language?.trim() && Object.keys(languages).includes(link.value.language));  \r\n    const checkValidation = ref(false);\r\n \r\n    const show= (linkToEdit)=>{  \r\n        checkValidation.value=false; \r\n        modalOpen.value = true;    \r\n        const  { url, name, language } = linkToEdit  \r\n        link.value = { url, name, language }; \r\n    }\r\n    const close = () => {      \r\n      modalOpen.value = false;  \r\n      checkValidation.value=false; \r\n      emit(\"onClose\");  \r\n    }  \r\n    const save = () =>{  \r\n      checkValidation.value=true; \r\n      if (isUrlValid.value && isLangValid.value){   \r\n        const newLink = { \"url\": link.value.url , \"name\": link.value.name , \"language\": link.value.language  };\r\n        modalOpen.value = false;        \r\n        emit(\"onClose\", newLink);      \r\n      }\r\n    }\r\n    \r\n    const isValidHttpUrl =(string)=> {\r\n        try {\r\n            const newUrl = new URL(string);\r\n            return newUrl.protocol === 'http:' || newUrl.protocol === 'https:';\r\n        }\r\n        catch(e){};\r\n        \r\n        return false;\r\n    }\r\n    defineExpose({\r\n        show\r\n    })\r\n  </script>","\r\n<template>\r\n  <button type=\"button\" class=\"btn btn-primary\" @click=\"addLink()\">\r\n    <slot name=\"link-button-label\">+ Add Link</slot>\r\n  </button>  \r\n  <link-editor ref=\"linkEditorRef\" @on-close=\"onLinkEditorClose\">\r\n    <template v-slot:modalTitle>\r\n      <slot name=\"link-dialog-title\"   >        \r\n        Edit link    \r\n      </slot>\r\n     </template>       \r\n  </link-editor>\r\n  <slot name=\"links-view\">\r\n    <km-view-links v-model=\"links\"   @on-delete = \"removeLink($event)\"   @on-edit = \"editLink($event)\"></km-view-links>  \r\n  </slot>\r\n</template>\r\n\r\n<script setup>\r\n  import { ref ,shallowRef} from 'vue'  \r\n  import kmViewLinks from './km-view-links.vue';\r\n  import linkEditor  from './link-editor.vue';\r\n\r\n  const linkEditorRef= shallowRef(null); \r\n  let editedLinkIndex = -1;   \r\n  const links = defineModel({type:Array, required:true, default:[]});\r\n\r\n    function addLink() {  \r\n        editLink(-1);\r\n    }      \r\n\r\n    function editLink(index) {  \r\n        editedLinkIndex = index;  \r\n        linkEditorRef.value.show(links.value[index] ||{})     \r\n    }\r\n\r\n    function removeLink(index) {  \r\n        links.value.splice(index, 1);   \r\n    }\r\n\r\n    function onLinkEditorClose(newValue) {    \r\n        if(Object.keys(newValue).length ==0) {// mean cacnel => return              \r\n            return;\r\n        } \r\n        else{\r\n            if(editedLinkIndex<0) {  \r\n                      \r\n                links.value.push(newValue);\r\n            } \r\n            else {        \r\n                links.value[editedLinkIndex]=newValue;\r\n            } \r\n            editedLinkIndex = -1;\r\n        }       \r\n    }\r\n    \r\n</script>\r\n"],"names":["languages","model","_useModel","__props","emit","__emit","links","computed","value","remove","index","edit","modalOpen","ref","link","isUrlValid","isValidHttpUrl","url","isLangValid","_link$value","language","trim","Object","keys","includes","checkValidation","show","linkToEdit","name","close","save","newLink","string","newUrl","URL","protocol","e","__expose","linkEditorRef","shallowRef","editedLinkIndex","addLink","editLink","removeLink","splice","onLinkEditorClose","newValue","length","push"],"mappings":"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"}